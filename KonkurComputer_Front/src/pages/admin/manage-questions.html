<!DOCTYPE html>
<html lang="en">

<head>
 <meta charset="UTF-8">
 <title>Manage Questions</title>
 <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
 <link rel="stylesheet" href="../../css/styles.css">
 <script src="../../js/admin/adminAuth.js"></script>
</head>

<body>
 <script>
  if (!checkAdminAuth()) {
   throw new Error('Unauthorized access');
  }
 </script>
 <!-- Navigation Bar -->
 <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container-fluid">
   <a class="navbar-brand" href="../admin/dashboard.html">AdminPanel</a>
   <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#adminNavbar"
    aria-controls="adminNavbar" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
   </button>
   <div class="collapse navbar-collapse" id="adminNavbar">
    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
     <li class="nav-item">
      <a class="nav-link" href="../admin/dashboard.html">Dashboard</a>
     </li>
     <li class="nav-item">
      <a class="nav-link active" aria-current="page" href="../admin/manage-questions.html">Manage
       Questions</a>
     </li>
     <li class="nav-item">
      <a class="nav-link" href="../admin/manage-lessons.html">Manage Lessons</a>
     </li>
     <li class="nav-item">
      <a class="nav-link" href="../admin/manage-users.html">Manage Users</a>
     </li>
    </ul>
    <form class="d-flex">
     <button class="btn btn-outline-danger" type="button" onclick="logout()">Logout</button>
    </form>
   </div>
  </div>
 </nav>

 <!-- Main Content -->
 <div class="container mt-4">
  <h2>Question Management</h2>
  <button class="btn btn-success mb-3" data-bs-toggle="modal" data-bs-target="#addQuestionModal">Add New
   Question</button>
  <table class="table table-bordered">
   <thead>
    <tr>
     <th>ID</th>
     <th>Question Text</th>
     <th>Lesson</th>
     <th>Chapter</th>
     <th>Difficulty</th>
     <th>Actions</th>
    </tr>
   </thead>
   <tbody id="question-table-body">
    <!-- Dynamic Rows Go Here -->
   </tbody>
  </table>
 </div>

 <!-- Add Question Modal -->
 <div class="modal fade" id="addQuestionModal" tabindex="-1" aria-labelledby="addQuestionModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
   <div class="modal-content">
    <div class="modal-header">
     <h5 class="modal-title" id="addQuestionModalLabel">Add New Question</h5>
     <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
    </div>
    <div class="modal-body">
     <form id="add-question-form">
      <div class="mb-3">
       <label for="question-text" class="form-label">Question Text</label>
       <textarea class="form-control" id="question-text" rows="3" required></textarea>
      </div>
      <div class="mb-3">
       <label for="options" class="form-label">Options</label>
       <div class="row">
        <div class="col-md-6 mb-2">
         <input type="text" class="form-control" placeholder="Option A" required>
        </div>
        <div class="col-md-6 mb-2">
         <input type="text" class="form-control" placeholder="Option B" required>
        </div>
        <div class="col-md-6 mb-2">
         <input type="text" class="form-control" placeholder="Option C" required>
        </div>
        <div class="col-md-6 mb-2">
         <input type="text" class="form-control" placeholder="Option D" required>
        </div>
       </div>
      </div>
      <div class="mb-3">
       <label for="correct-answer" class="form-label">Correct Answer</label>
       <select class="form-select" id="correct-answer" required>
        <option selected disabled>Select correct option</option>
        <option value="A">Option A</option>
        <option value="B">Option B</option>
        <option value="C">Option C</option>
        <option value="D">Option D</option>
       </select>
      </div>
      <div class="mb-3">
       <label for="difficulty" class="form-label">Difficulty Level</label>
       <select class="form-select" id="difficulty" required>
        <option selected disabled>Select difficulty</option>
        <option value="easy">Easy</option>
        <option value="medium">Medium</option>
        <option value="hard">Hard</option>
       </select>
      </div>
      <div class="mb-3">
       <label for="lesson" class="form-label">Lesson</label>
       <select class="form-select" id="lesson" required>
        <option selected disabled>Select lesson</option>
        <!-- Lessons will be populated here dynamically -->
       </select>
      </div>
      <div class="mb-3">
       <label for="chapter" class="form-label">Chapter</label>
       <select class="form-select" id="chapter" required>
        <option selected disabled>Select chapter</option>
        <!-- Chapters will be populated here dynamically based on selected lesson -->
       </select>
      </div>
      <div class="mb-3">
       <label for="question-image" class="form-label">Upload Image (Optional)</label>
       <input class="form-control" type="file" id="question-image" accept="image/*">
      </div>
      <div class="mb-3">
       <label for="question-solution" class="form-label">Question Solution</label>
       <textarea class="form-control" id="question-solution" rows="3" required></textarea>
      </div>
      <button type="submit" class="btn btn-success">Add Question</button>
     </form>
    </div>
   </div>
  </div>
 </div>

 <!-- Edit Question Modal -->
 <div class="modal fade" id="editQuestionModal" tabindex="-1" aria-labelledby="editQuestionModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-lg">
   <div class="modal-content">
    <div class="modal-header">
     <h5 class="modal-title" id="editQuestionModalLabel">Edit Question</h5>
     <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
    </div>
    <div class="modal-body">
     <form id="edit-question-form">
      <!-- Question Text -->
      <div class="mb-3">
       <label for="edit-question-text" class="form-label">Question Text</label>
       <textarea class="form-control" id="edit-question-text" rows="3" required></textarea>
      </div>
      <!-- Options -->
      <div class="mb-3">
       <label for="edit-options" class="form-label">Options</label>
       <div class="row">
        <div class="col-md-6 mb-2">
         <input type="text" class="form-control" id="edit-option-a" required>
        </div>
        <div class="col-md-6 mb-2">
         <input type="text" class="form-control" id="edit-option-b" required>
        </div>
        <div class="col-md-6 mb-2">
         <input type="text" class="form-control" id="edit-option-c" required>
        </div>
        <div class="col-md-6 mb-2">
         <input type="text" class="form-control" id="edit-option-d" required>
        </div>
       </div>
      </div>
      <!-- Correct Answer -->
      <div class="mb-3">
       <label for="edit-correct-answer" class="form-label">Correct Answer</label>
       <select class="form-select" id="edit-correct-answer" required>
        <option selected disabled>Select correct option</option>
        <option value="A">Option A</option>
        <option value="B">Option B</option>
        <option value="C">Option C</option>
        <option value="D">Option D</option>
       </select>
      </div>
      <!-- Difficulty -->
      <div class="mb-3">
       <label for="edit-difficulty" class="form-label">Difficulty Level</label>
       <select class="form-select" id="edit-difficulty" required>
        <option selected disabled>Select difficulty</option>
        <option value="easy">Easy</option>
        <option value="medium">Medium</option>
        <option value="hard">Hard</option>
       </select>
      </div>
      <!-- Lesson and Chapter -->
      <div class="mb-3">
       <label for="edit-lesson" class="form-label">Lesson</label>
       <select class="form-select" id="edit-lesson" required>
        <option selected disabled>Select lesson</option>
        <!-- Lessons will be populated here dynamically -->
       </select>
      </div>
      <div class="mb-3">
       <label for="edit-chapter" class="form-label">Chapter</label>
       <select class="form-select" id="edit-chapter" required>
        <option selected disabled>Select chapter</option>
        <!-- Chapters will be populated here dynamically based on selected lesson -->
       </select>
      </div>
      <!-- Image Upload -->
      <div class="mb-3">
       <label for="edit-question-image" class="form-label">Upload New Image (Optional)</label>
       <input class="form-control" type="file" id="edit-question-image" accept="image/*">
       <!-- Display the existing image if available -->
       <div id="edit-image-preview" class="mt-2">
        <!-- Existing image will be shown here -->
       </div>
      </div>
      <!-- Solution -->
      <div class="mb-3">
       <label for="edit-question-solution" class="form-label">Question Solution</label>
       <textarea class="form-control" id="edit-question-solution" rows="3" required></textarea>
       <!-- Add this hidden input field inside the Edit Question Modal form -->
       <input type="hidden" id="edit-question-id">
      </div>
      <button type="submit" class="btn btn-success">Save Changes</button>
     </form>
    </div>
   </div>
  </div>
 </div>

 <!-- Bootstrap JS and custom scripts -->
 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

 <script src="../../js/admin/manage-questions.js"></script>
</body>

</html>